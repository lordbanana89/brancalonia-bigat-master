{
  "_id": "brancalonia004",
  "name": "üç∫ Rissa da Taverna",
  "type": "script",
  "author": "brancalonia",
  "img": "icons/skills/melee/unarmed-punch-fist.webp",
  "scope": "global",
  "command": "// Macro per iniziare una Rissa da Taverna\nif (!game.modules.get('brancalonia-bigat')?.active) {\n  ui.notifications.error('Modulo Brancalonia non attivo!');\n  return;\n}\n\nconst brawl = game.brancalonia?.TavernBrawl;\nif (!brawl) {\n  ui.notifications.error('Sistema Risse da Taverna non disponibile!');\n  return;\n}\n\nconst tokens = canvas.tokens.controlled;\nif (tokens.length === 0) {\n  ui.notifications.warn('Seleziona almeno un token per partecipare alla rissa!');\n  return;\n}\n\nnew Dialog({\n  title: 'üç∫ Inizia Rissa da Taverna',\n  content: `\n    <div style=\"padding: 10px;\">\n      <h3>Prepara la Rissa!</h3>\n      <p><strong>Partecipanti:</strong> ${tokens.length} personaggi selezionati</p>\n      <div style=\"margin: 10px 0;\">\n        <label for=\"brawl-difficulty\">Difficolt√†:</label>\n        <select id=\"brawl-difficulty\" style=\"margin-left: 10px;\">\n          <option value=\"easy\">Facile (CD 10)</option>\n          <option value=\"normal\" selected>Normale (CD 13)</option>\n          <option value=\"hard\">Difficile (CD 15)</option>\n          <option value=\"legendary\">Leggendaria (CD 18)</option>\n        </select>\n      </div>\n      <div style=\"margin: 10px 0;\">\n        <label for=\"brawl-location\">Luogo:</label>\n        <input type=\"text\" id=\"brawl-location\" placeholder=\"es. Taverna del Porco Ubriaco\" style=\"width: 200px;\"/>\n      </div>\n      <hr>\n      <p style=\"text-align: center; font-style: italic;\">\"Nessuno sa chi ha iniziato, ma tutti sanno chi finir√† male!\"</p>\n    </div>\n  `,\n  buttons: {\n    start: {\n      icon: '<i class=\"fas fa-fist-raised\"></i>',\n      label: 'Inizia la Rissa!',\n      callback: (html) => {\n        const difficulty = html.find('#brawl-difficulty').val();\n        const location = html.find('#brawl-location').val() || 'Taverna Anonima';\n        \n        // Inizia la rissa\n        brawl.startBrawl({\n          participants: tokens.map(t => t.actor),\n          difficulty: difficulty,\n          location: location\n        });\n      }\n    },\n    random: {\n      icon: '<i class=\"fas fa-dice\"></i>',\n      label: 'Evento Casuale',\n      callback: () => {\n        // Tira su tabella eventi rissa\n        brawl.rollBrawlEvent();\n      }\n    },\n    cancel: {\n      icon: '<i class=\"fas fa-times\"></i>',\n      label: 'Meglio di no...'\n    }\n  },\n  default: 'start'\n}).render(true);",
  "folder": null,
  "sort": 100003,
  "ownership": {
    "default": 0
  },
  "flags": {
    "brancalonia-bigat": {
      "category": "combat"
    }
  },
  "_stats": {
    "systemId": "dnd5e",
    "systemVersion": "3.3.1",
    "coreVersion": "13.0.0",
    "createdTime": 1700000003000,
    "modifiedTime": 1700000003000,
    "lastModifiedBy": "brancalonia"
  },
  "_key": "!macros!brancalonia004"
}