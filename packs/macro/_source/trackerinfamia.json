{
  "_id": "DFnh5vJWW3kWDWWh",
  "name": "ðŸ˜ˆ Tracker Infamia",
  "type": "script",
  "author": "Brancalonia",
  "img": "icons/skills/social/intimidation-impressing.webp",
  "scope": "global",
  "command": "// TRACKER INFAMIA/NOTORIETÃ€\n// Gestisce il livello di infamia del personaggio (0-20)\n\nconst actor = game.user.character || canvas.tokens.controlled[0]?.actor;\nif (!actor) {\n  ui.notifications.warn(\"Seleziona un personaggio!\");\n  return;\n}\n\n// Recupera infamia attuale\nlet infamia = actor.getFlag(\"world\", \"infamia\") || 0;\n\n// Funzione per ottenere il titolo\nfunction getTitolo(level) {\n  if (level <= 3) return \"Nessuno\";\n  if (level <= 7) return \"Canaglia Locale\";\n  if (level <= 11) return \"Farabutto Noto\";\n  if (level <= 15) return \"Brigante Famoso\";\n  if (level <= 19) return \"Leggenda Vivente\";\n  return \"Re dei Briganti\";\n}\n\n// Funzione per ottenere i benefici\nfunction getBenefici(level) {\n  if (level <= 3) return \"Sconosciuto, ignorato\";\n  if (level <= 7) return \"-1 ducato sui prezzi nelle taverne\";\n  if (level <= 11) return \"Vantaggio Intimidire, svantaggio con autoritÃ \";\n  if (level <= 15) return \"Seguaci minori, bersaglio di cacciatori di taglie\";\n  if (level <= 19) return \"Canzoni su di te, vantaggio con criminali\";\n  return \"Controlli una regione, propria banda, nemico pubblico n.1\";\n}\n\n// Dialog per modificare\nnew Dialog({\n  title: \"Tracker Infamia/NotorietÃ \",\n  content: `\n    <h2>${actor.name}</h2>\n    <p><strong>Infamia Attuale:</strong> ${infamia}/20</p>\n    <p><strong>Titolo:</strong> ${getTitolo(infamia)}</p>\n    <p><strong>Effetti:</strong> ${getBenefici(infamia)}</p>\n    <hr>\n    <p>Modifica Infamia:</p>\n    <div style=\"display: flex; gap: 10px; justify-content: center;\">\n      <input type=\"number\" id=\"infamia-change\" value=\"1\" min=\"-20\" max=\"20\" style=\"width: 60px;\"/>\n    </div>\n  `,\n  buttons: {\n    add: {\n      icon: \"<i class='fas fa-plus'></i>\",\n      label: \"Aggiungi\",\n      callback: async (html) => {\n        const change = parseInt(html.find(\"#infamia-change\").val());\n        infamia = Math.max(0, Math.min(20, infamia + change));\n        await actor.setFlag(\"world\", \"infamia\", infamia);\n        \n        ChatMessage.create({\n          speaker: ChatMessage.getSpeaker({actor}),\n          content: `<h3>ðŸ˜ˆ Infamia ${change > 0 ? \"Aumentata\" : \"Diminuita\"}!</h3>\n          <p><strong>${actor.name}</strong></p>\n          <p>Infamia: ${infamia - change} â†’ <strong>${infamia}</strong></p>\n          <p>Nuovo Titolo: <strong>${getTitolo(infamia)}</strong></p>\n          <p><em>${getBenefici(infamia)}</em></p>`\n        });\n      }\n    },\n    subtract: {\n      icon: \"<i class='fas fa-minus'></i>\",\n      label: \"Sottrai\",\n      callback: async (html) => {\n        const change = parseInt(html.find(\"#infamia-change\").val());\n        infamia = Math.max(0, Math.min(20, infamia - change));\n        await actor.setFlag(\"world\", \"infamia\", infamia);\n        \n        ChatMessage.create({\n          speaker: ChatMessage.getSpeaker({actor}),\n          content: `<h3>ðŸ˜ˆ Infamia Diminuita!</h3>\n          <p><strong>${actor.name}</strong></p>\n          <p>Infamia: ${infamia + change} â†’ <strong>${infamia}</strong></p>\n          <p>Nuovo Titolo: <strong>${getTitolo(infamia)}</strong></p>\n          <p><em>${getBenefici(infamia)}</em></p>`\n        });\n      }\n    },\n    close: {\n      icon: \"<i class='fas fa-times'></i>\",\n      label: \"Chiudi\"\n    }\n  },\n  default: \"close\"\n}).render(true);",
  "ownership": {
    "default": 0
  },
  "flags": {
    "core": {
      "sourceId": "Macro.infamia001"
    },
    "brancalonia-bigat": {
      "migrated": true,
      "version": "12.0.4"
    }
  },
  "_stats": {
    "systemId": "dnd5e",
    "systemVersion": "3.3.1",
    "coreVersion": "13.347"
  },
  "_key": "!macros!infamia001",
  "effects": [],
  "sort": 0,
  "folder": null,
  "system": {
    "identifier": "trackerinfamia",
    "source": "Brancalonia"
  }
}